# OnlyOffice JsAPI 宏使用说明

本项目使用 **JsAPI（宏）** 实现功能，不使用 Plugins API 和 Automation API。

## 宏文件说明

### 1. AddComment.js - 添加批注
在当前光标位置添加一条批注。

**使用方法：**
1. 在 OnlyOffice 编辑器中，打开"开发工具" -> "宏"
2. 点击"新建宏"
3. 复制 `AddComment.js` 中的代码
4. 粘贴到宏编辑器中
5. 点击"运行"

**功能：**
- 在当前光标位置添加批注
- 设置批注作者和显示名称
- 在控制台显示成功消息

---

### 2. GetAllComments.js - 获取所有批注
获取文档中的所有批注并显示。

**使用方法：**
1. 在 OnlyOffice 编辑器中，打开"开发工具" -> "宏"
2. 点击"新建宏"
3. 复制 `GetAllComments.js` 中的代码
4. 粘贴到宏编辑器中
5. 点击"运行"

**功能：**
- 遍历文档中的所有批注
- 在控制台输出批注列表（JSON 格式）
- 将批注列表追加到文档末尾

---

### 3. SearchText.js - 搜索文字
在文档中搜索指定的文字并定位到第一个匹配位置。

**使用方法：**
1. 在 OnlyOffice 编辑器中，打开"开发工具" -> "宏"
2. 点击"新建宏"
3. 复制 `SearchText.js` 中的代码
4. **修改代码中的 `searchText` 变量为要搜索的文字**
5. 粘贴到宏编辑器中
6. 点击"运行"

**功能：**
- 在文档中搜索指定的文字
- 显示匹配数量和位置（段落号）
- 自动滚动到第一个匹配位置并高亮显示

---

## 使用 JsAPI 的优势

1. **完全免费**：JsAPI 在社区版中完全可用
2. **功能强大**：可以访问文档的所有内容和方法
3. **灵活定制**：可以根据需求修改宏代码
4. **无需部署**：直接在编辑器中运行，无需安装插件

## 注意事项

- 宏代码在编辑器内部运行，无法从外部 Vue 应用直接调用
- 每次使用需要手动运行宏
- 可以保存宏以便重复使用（在宏编辑器中点击"保存"）

## 扩展功能

你可以基于这些宏代码，修改和扩展功能：
- 修改批注内容格式
- 添加更多搜索条件
- 实现批量操作
- 添加错误处理
- 等等

